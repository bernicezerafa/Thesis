SELECT DISTINCT e.Exam1ID, e.Exam2ID
FROM dbo.CONTEMPORANEOUS_EXAMS e 
JOIN dbo.STUDYUNITS s ON e.Exam1ID = s.ID OR e.exam2ID = s.ID 
WHERE s.semester = '1'


SELECT ex.Exam2ID
FROM dbo.CONTEMPORANEOUS_EXAMS ex
WHERE ex.Exam1ID IN (
		SELECT DISTINCT e.Exam1ID
		FROM dbo.CONTEMPORANEOUS_EXAMS e
		JOIN dbo.STUDYUNITS s ON e.Exam1ID = s.ID
		JOIN dbo.STUDYUNITS st ON e.Exam2ID = st.ID
		WHERE s.semester = '2'
		GROUP BY Exam1ID
		HAVING COUNT(e.Exam2ID) > 1
)